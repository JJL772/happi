

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Containers &mdash; Happi Deck 1.6.1+7.ga6809a1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release History" href="releases.html" />
    <link rel="prev" title="happi.backends.qs_db.QSBackend" href="generated/happi.backends.qs_db.QSBackend.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Happi Deck
          

          
          </a>

          
            
            
              <div class="version">
                1.6.1+7.ga6809a1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Using the Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">Creating New Device Types</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="client_api.html">Client API</a></li>
<li class="toctree-l1"><a class="reference internal" href="backends.html">Supported Backends</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Containers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#extending-containers">Extending Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-containers">Loading Containers</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Happi Deck</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Containers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/containers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="containers">
<span id="device-label"></span><h1>Containers<a class="headerlink" href="#containers" title="Permalink to this headline">¶</a></h1>
<p>A generic container is available for use that holds a few basic traits
pertinent to Ophyd devices. Largely this is available to provide a common
base that more specific devices will inherit from.</p>
<dl class="py class">
<dt id="happi.OphydItem">
<em class="property">class </em><code class="sig-prename descclassname">happi.</code><code class="sig-name descname">OphydItem</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#happi.OphydItem" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="happi.OphydItem.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#happi.OphydItem.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Arguments to pass to device_class</p>
</dd></dl>

<dl class="py attribute">
<dt id="happi.OphydItem.kwargs">
<code class="sig-name descname">kwargs</code><a class="headerlink" href="#happi.OphydItem.kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyword arguments to pass to device_class</p>
</dd></dl>

<dl class="py attribute">
<dt id="happi.OphydItem.prefix">
<code class="sig-name descname">prefix</code><a class="headerlink" href="#happi.OphydItem.prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>A base PV for all related records</p>
</dd></dl>

</dd></dl>

<p>These inherit from the most generic information that can be included:</p>
<dl class="py class">
<dt id="happi.HappiItem">
<em class="property">class </em><code class="sig-prename descclassname">happi.</code><code class="sig-name descname">HappiItem</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#happi.HappiItem" title="Permalink to this definition">¶</a></dt>
<dd><p>The smallest description of an object that can be entered in <code class="docutils literal notranslate"><span class="pre">happi</span></code></p>
<p>The class does not need to be intialized with any specific piece of
information except a name, but all of the attributes listed by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">HappiItem.info_names</span></code> can be used to assign values to
<a class="reference internal" href="develop.html#happi.device.EntryInfo" title="happi.device.EntryInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">EntryInfo</span></code></a> upon initialization.  Pieces of information that are
deemed mandatory by the class must be filled in before the device is loaded
into the database. See <code class="xref py py-attr docutils literal notranslate"><span class="pre">mandatory_info</span></code> to see which
attributes are neccesary.</p>
<p>Additional metadata can be given to the device in the form of keywords on
initialization, this information is kept in the <a class="reference internal" href="#happi.HappiItem.extraneous" title="happi.HappiItem.extraneous"><code class="xref py py-attr docutils literal notranslate"><span class="pre">extraneous</span></code></a>
attribute, and will be saved in to the database as long as it does not
clash with an existing piece of metadata that the client uses to organize
devices.</p>
<dl class="py attribute">
<dt id="happi.HappiItem.entry_info">
<code class="sig-name descname">entry_info</code><a class="headerlink" href="#happi.HappiItem.entry_info" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of all the <a class="reference internal" href="develop.html#happi.device.EntryInfo" title="happi.device.EntryInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">EntryInfo</span></code></a> associated with the device</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="happi.HappiItem.extraneous">
<code class="sig-name descname">extraneous</code><a class="headerlink" href="#happi.HappiItem.extraneous" title="Permalink to this definition">¶</a></dt>
<dd><p>Storage for information supplied during initialization that does not
correspond to a specific EntryInfo</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>EntryError:</strong> – If a piece of information supplied at startup is of the incorrect type</p></li>
<li><p><strong>ContainerError:</strong> – If one of the pieces of <a class="reference internal" href="develop.html#happi.device.EntryInfo" title="happi.device.EntryInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">EntryInfo</span></code></a> has a default value of the
    incorrect type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">HappiItem</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;my_device&#39;</span><span class="p">,</span>         <span class="c1"># Alias name for device</span>
              <span class="n">note</span>  <span class="o">=</span> <span class="s1">&#39;Example&#39;</span><span class="p">,</span>          <span class="c1"># Piece of arbitrary metadata</span>
             <span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="happi.HappiItem.active">
<code class="sig-name descname">active</code><a class="headerlink" href="#happi.HappiItem.active" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the instance is actively deployed</p>
</dd></dl>

<dl class="py attribute">
<dt id="happi.HappiItem.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#happi.HappiItem.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Arguments to pass to device_class</p>
</dd></dl>

<dl class="py attribute">
<dt id="happi.HappiItem.device_class">
<code class="sig-name descname">device_class</code><a class="headerlink" href="#happi.HappiItem.device_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Python class that represents the instance</p>
</dd></dl>

<dl class="py attribute">
<dt id="happi.HappiItem.documentation">
<code class="sig-name descname">documentation</code><a class="headerlink" href="#happi.HappiItem.documentation" title="Permalink to this definition">¶</a></dt>
<dd><p>Relevant documentation for the instance</p>
</dd></dl>

<dl class="py attribute">
<dt id="happi.HappiItem.kwargs">
<code class="sig-name descname">kwargs</code><a class="headerlink" href="#happi.HappiItem.kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyword arguments to pass to device_class</p>
</dd></dl>

<dl class="py attribute">
<dt id="happi.HappiItem.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#happi.HappiItem.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Shorthand Python-valid name for the Python instance</p>
</dd></dl>

<dl class="py method">
<dt id="happi.HappiItem.post">
<code class="sig-name descname">post</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#happi.HappiItem.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a document to be loaded into the happi database</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>post</strong> – Dictionary of all contained information</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="happi.HappiItem.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#happi.HappiItem.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Overwritten when the device instance is loaded from the client</p>
</dd></dl>

<dl class="py method">
<dt id="happi.HappiItem.show_info">
<code class="sig-name descname">show_info</code><span class="sig-paren">(</span><em class="sig-param">handle=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#happi.HappiItem.show_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the device instance information in a PrettyTable</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>handle</strong> (<em>file-like</em><em>, </em><em>optional</em>) – Option to write to a file-like object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="extending-containers">
<h2>Extending Containers<a class="headerlink" href="#extending-containers" title="Permalink to this headline">¶</a></h2>
<p>Happi allow users to extend the containers list via Python
<a class="reference external" href="https://packaging.python.org/specifications/entry-points/">entry points</a>
specified by the <strong>happi.containers</strong> keyword. An example entry points can be
found <a class="reference external" href="https://github.com/pcdshub/pcdsdevices/blob/master/setup.py">here</a>.</p>
<p><cite>HappiRegistry</cite> takes care of loading the entry points and making them
available throughout the library.</p>
</div>
<div class="section" id="loading-containers">
<h2>Loading Containers<a class="headerlink" href="#loading-containers" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="happi.from_container">
<code class="sig-prename descclassname">happi.</code><code class="sig-name descname">from_container</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device</span></em>, <em class="sig-param"><span class="n">attach_md</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_cache</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">threaded</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#happi.from_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a device from a happi container</p>
<p>The container is queried for the device_class, args and kwargs. Then if the
associated package is not already loaded it is imported. The specified
class is then instantiated with the given args and kwargs provided.</p>
<p>This function does not attempt to catch exceptions either during module
imports or device creation. If you would like a series of independent
devices to be loaded use <a class="reference internal" href="#happi.load_devices" title="happi.load_devices"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_devices()</span></code></a>.</p>
<p>By default, the instantiated object has the original container added on as
<code class="docutils literal notranslate"><span class="pre">.md</span></code>. This allows applications to utilize additional metadata
information that may not be included in the basic class constructor. On
later calls, the container you request is checked against this stored
metadata. If a discrepancy is found the object is <strong>forced</strong> to reload, not
retrieved from the cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<em>happi.Device</em>) – </p></li>
<li><p><strong>attach_md</strong> (<em>bool</em><em>, </em><em>optional</em>) – Attach the container to the instantiated object as <cite>md</cite></p></li>
<li><p><strong>use_cache</strong> (<em>bool</em><em>, </em><em>optional</em>) – When devices are loaded they are stored in the <code class="docutils literal notranslate"><span class="pre">happi.cache</span></code>
dictionary. This means that repeated attempts to load the device will
return the same object. This prevents unnecessary EPICS connections
from being initialized in the same process. If a new object is
needed, set <cite>use_cache</cite> to False and a new object will be created,
overriding the current cached object. An object with matching name
and differing metadata will always return a new instantiation of the
device.</p></li>
<li><p><strong>threaded</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set this to True when calling inside a thread.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>obj</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>happi.Device.device_class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="happi.load_devices">
<code class="sig-prename descclassname">happi.</code><code class="sig-name descname">load_devices</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">devices</span></em>, <em class="sig-param"><span class="n">pprint</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">namespace</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cache</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">threaded</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">post_load</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#happi.load_devices" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a series of devices into a namespace</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*devices</strong> – List of happi containers to load</p></li>
<li><p><strong>pprint</strong> (<em>bool</em><em>, </em><em>optional</em>) – Print results of device loads</p></li>
<li><p><strong>namespace</strong> (<em>object</em><em>, </em><em>optional</em>) – Namespace to collect loaded devices in. By default this will be a
<code class="docutils literal notranslate"><span class="pre">types.SimpleNamespace</span></code></p></li>
<li><p><strong>use_cache</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, we’ll ignore the cache and always make new
devices.</p></li>
<li><p><strong>threaded</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to True to create each device in a background thread.  Note that
this assumes that no two devices provided are the same. You are not
guaranteed to load from the cache correctly if you ask for the same
device to be loaded twice in the same threaded load.</p></li>
<li><p><strong>post_load</strong> (<em>function</em><em>, </em><em>optional</em>) – Function of one argument to run on each device after instantiation.
This is your opportunity to check for good device health during the
threaded load.</p></li>
<li><p><strong>kwargs</strong> – Are passed to <a class="reference internal" href="#happi.from_container" title="happi.from_container"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_container()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="releases.html" class="btn btn-neutral float-right" title="Release History" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="generated/happi.backends.qs_db.QSBackend.html" class="btn btn-neutral float-left" title="happi.backends.qs_db.QSBackend" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017, SLAC National Accelerator Laboratory

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>